<!DOCTYPE html>
<html>
    <head>
        <title>Map-plugin</title>
        <link href="fonts/font-awesome-4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
        <!--<link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>-->
        <link href="assets/css/style.css" rel="stylesheet" type="text/css"/>
        <link href="bower_components/jquery-ui/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <button id="openMap" >Открыть</button>  
        <!--<div id="newEl">Тут что то да появится, если кнопку нажать</div>-->
        <!--<div id="modal"><div class="map"></div></div>-->


        <!--<input type="button" value="Нажми меня" onclick="newInf();">-->

        <!--        <button type="button" class="btn btn-success" data-toggle='modal' data-target='#modal'>
                    Открыть
                </button>-->

        <!--        <div class="modal" id="modal">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title">Карта</h4>
                                <button class="close" type="button" data-dismiss='modal'>
                                    <i class="fa fa-close"></i>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div id="map"></div>
                                <div id="coords"></div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-danger" type="button" data-dismiss='modal'>Закрыть</button>
                            </div>
                        </div>
                    </div>
                </div>-->
        <script src="bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>      
        <!--<script src="bower_components/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>-->
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyALVfmpKfIqdaInJ41_JAnZc46em_bBOIM&signed_in=true" async defer></script>
        <script src="assets/js/newjavascript.js" type="text/javascript"></script>
        <script src="bower_components/jquery-ui/jquery-ui.js" type="text/javascript"></script>
        <script type="text/javascript">

            $('#openMap').on('click', function () {
                function OpenNewWindow(elem) {
                    this.elem = elem;
                    console.log(this.elem.attr( "id"))
                    this.elem.css({'width': '600px',
                        'height': '400px',
                        'backgroundColor': '#000',
                        'position': 'absolute'}).draggable();
                    this.figures = [];
                    this.map = this.elem.find('.map')
                            .css({'width': '100%',
                                'height': '300px',
                                'backgroundColor': '#eee',
                            }).mappolydr({
                                'id': this.elem.attr( "id"),
                                'coords' : this.elem.find('.coords'),
                                'figures': this.figures
                            });
                }

                var modal = document.createElement('div');
                document.body.appendChild(modal);

                var currentId = str_rand();
                modal.id = currentId;

                var close = document.createElement('div');
                close.setAttribute('onclick', 'remove(this.parentNode);')
                modal.appendChild(close);

                var txt = document.createTextNode('x');
                close.appendChild(txt);

                var map = document.createElement('div');
                map.classList.add('map');
                modal.appendChild(map);
                
                var coords = document.createElement('input');
                coords.classList.add('coords');
                modal.appendChild(coords);
                
                var txtCoords = document.createTextNode( '')
                coords.appendChild(txtCoords);


                var curEl = $('#' + currentId);
                console.log(curEl)
                var newWindow = new OpenNewWindow(curEl);
            })

            function remove(el) {
                el.parentNode.removeChild(el);
            }

            function str_rand() {
                var result = '';
                var words = '0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM';
                var max_position = words.length - 1;
                for (var i = 0; i < 5; ++i) {
                   var position = Math.floor(Math.random() * max_position);
                   result = result + words.substring(position, position + 1);
                }
                return result;
            }

        </script>
    </body>
</html>
